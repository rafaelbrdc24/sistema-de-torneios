<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<link rel="icon" type="image/png" href="icone.png">
<title>Campeonato de Luta</title>

<style>
:root {
    --bg: #0f1220;
    --card: #1b1f3a;
    --accent: #f1c40f;
    --win: #2ecc71;
    --path: #3498db;
    --champion-path: #f39c12;
    --champion-glow: #ffd700;
    --text: #ffffff;
    --muted: #9aa0c7;
}

* { box-sizing: border-box; }

body {
    margin: 0;
    font-family: "Segoe UI", system-ui, sans-serif;
    background: linear-gradient(135deg, #0f1220, #15193c);
    background-attachment: fixed;
    color: var(--text);
    min-height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 20px;
}

.container {
    width: 100%;
    max-width: 1100px;
    padding: 30px;
}

h1 {
    text-align: center;
    color: var(--accent);
    font-size: 2.5em;
    margin-bottom: 10px;
    text-shadow: 0 0 20px rgba(241, 196, 15, 0.5);
    letter-spacing: 2px;
}

.champion-announcement {
    text-align: center;
    margin: 20px 0;
    padding: 20px;
    background: linear-gradient(135deg, rgba(243, 156, 18, 0.2), rgba(230, 126, 34, 0.2));
    border-radius: 12px;
    border: 2px solid var(--champion-glow);
    box-shadow: 0 0 30px rgba(255, 215, 0, 0.4);
    animation: announcementPulse 3s ease-in-out infinite;
}

.champion-announcement h2 {
    color: var(--champion-glow);
    margin: 0;
    font-size: 1.8em;
    text-shadow: 0 0 15px rgba(255, 215, 0, 0.8);
}

.champion-announcement p {
    color: var(--text);
    margin: 10px 0 0 0;
    font-size: 1.2em;
    font-weight: bold;
}

@keyframes announcementPulse {
    0%, 100% {
        box-shadow: 0 0 30px rgba(255, 215, 0, 0.4);
    }
    50% {
        box-shadow: 0 0 50px rgba(255, 215, 0, 0.7);
    }
}

/* ===== SETUP ===== */
.setup {
    background: linear-gradient(135deg, var(--card), #252a4a);
    padding: 30px;
    border-radius: 15px;
    box-shadow: 0 15px 40px rgba(0,0,0,.5);
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.setup label {
    color: var(--muted);
    display: block;
    margin-top: 10px;
}

.setup select,
.setup input {
    width: 100%;
    padding: 10px;
    margin-top: 5px;
    border-radius: 6px;
    border: none;
}

.setup button {
    width: 100%;
    padding: 14px;
    margin-top: 12px;
    border: none;
    border-radius: 8px;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 16px;
    text-transform: uppercase;
    letter-spacing: 1px;
}

.setup button:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
}

.setup button:active {
    transform: translateY(0);
}

.start { background: var(--accent); color: #000; }
.shuffle { background: #3498db; color: #fff; }

/* ===== BRACKET ===== */
.bracket {
    display: flex;
    gap: 40px;
    margin-top: 40px;
    overflow-x: auto;
    padding: 20px 0;
    position: relative;
}

.round {
    display: flex;
    flex-direction: column;
    gap: 15px;
    position: relative;
    min-width: 180px;
}

.round h2 {
    text-align: center;
    color: var(--accent);
    font-size: 18px;
    margin-bottom: 10px;
    text-shadow: 0 0 10px rgba(241, 196, 15, 0.5);
    font-weight: bold;
    padding: 10px;
    background: rgba(241, 196, 15, 0.1);
    border-radius: 8px;
    border: 1px solid rgba(241, 196, 15, 0.3);
}

.match {
    background: linear-gradient(135deg, var(--card), #252a4a);
    padding: 14px 18px;
    min-width: 170px;
    text-align: center;
    border-radius: 12px;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    border: 2px solid rgba(255, 255, 255, 0.1);
    position: relative;
    overflow: hidden;
    font-size: 15px;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
}

.match:hover:not(.empty):not(.champion-path) {
    background: linear-gradient(135deg, #23286b, #2d3570);
    transform: translateY(-3px) scale(1.03);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
    border-color: rgba(52, 152, 219, 0.5);
}

.match.empty {
    color: var(--muted);
    cursor: default;
}

.match.winner {
    background: linear-gradient(135deg, var(--win), #27ae60);
    color: #000;
    font-weight: bold;
    border: 2px solid #27ae60;
    box-shadow: 0 4px 15px rgba(46, 204, 113, 0.4);
}

.match.path {
    border: 2px solid var(--path);
    box-shadow: 0 0 10px rgba(52,152,219,.7);
}

.match.champion-path {
    background: linear-gradient(135deg, #f39c12, #e67e22);
    border: 3px solid var(--champion-glow);
    box-shadow: 
        0 0 20px rgba(255, 215, 0, 0.8),
        0 0 40px rgba(255, 215, 0, 0.5),
        inset 0 0 20px rgba(255, 255, 255, 0.2);
    color: #000;
    font-weight: bold;
    animation: championGlow 2s ease-in-out infinite;
    position: relative;
    transform: scale(1.05);
}

.match.champion-path::before {
    content: "üëë";
    position: absolute;
    left: -25px;
    top: 50%;
    transform: translateY(-50%);
    font-size: 20px;
    animation: crownFloat 2s ease-in-out infinite;
}

.match.champion-path::after {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(45deg, transparent 30%, rgba(255, 255, 255, 0.3) 50%, transparent 70%);
    animation: shimmer 3s infinite;
    border-radius: 8px;
}

@keyframes championGlow {
    0%, 100% {
        box-shadow: 
            0 0 20px rgba(255, 215, 0, 0.8),
            0 0 40px rgba(255, 215, 0, 0.5),
            inset 0 0 20px rgba(255, 255, 255, 0.2);
    }
    50% {
        box-shadow: 
            0 0 30px rgba(255, 215, 0, 1),
            0 0 60px rgba(255, 215, 0, 0.7),
            inset 0 0 20px rgba(255, 255, 255, 0.3);
    }
}

@keyframes crownFloat {
    0%, 100% {
        transform: translateY(-50%) translateX(0);
    }
    50% {
        transform: translateY(-50%) translateX(-5px);
    }
}

@keyframes shimmer {
    0% {
        transform: translateX(-100%);
    }
    100% {
        transform: translateX(100%);
    }
}

/* Linha conectando o caminho do campe√£o */
.champion-connection {
    position: absolute;
    background: linear-gradient(90deg, var(--champion-glow), transparent);
    height: 3px;
    z-index: 1;
    box-shadow: 0 0 10px rgba(255, 215, 0, 0.6);
    animation: pathGlow 2s ease-in-out infinite;
}

@keyframes pathGlow {
    0%, 100% {
        opacity: 0.6;
    }
    50% {
        opacity: 1;
    }
}

/* ===== FOOTER ===== */
.footer {
    text-align: center;
    margin-top: 30px;
}

.footer button {
    padding: 10px 20px;
    border-radius: 6px;
    border: none;
    background: #e74c3c;
    color: #fff;
    cursor: pointer;
}
</style>
</head>

<body>
<div class="container">

<h1>üèÜ Campeonato de Luta</h1>

<div class="setup" id="setup">
    <label>Quantidade de participantes</label>
    <select id="quantidade" onchange="criarInputs()">
        <option value="4">4</option>
        <option value="8" selected>8</option>
        <option value="16">16</option>
        <option value="32">32</option>
    </select>

    <div id="inputs"></div>

    <button class="shuffle" onclick="embaralharInputs()">üîÄ Embaralhar novamente</button>
    <button class="start" onclick="iniciarTorneio()">Iniciar Torneio</button>
</div>

<div id="bracket" class="bracket" style="display:none;"></div>

<div class="footer" id="footer" style="display:none;">
    <button onclick="location.reload()">Reiniciar</button>
</div>

</div>

<script>
let rodadas = [];
let historico = [];

/* ===== INPUTS ===== */
function criarInputs() {
    const qtd = +quantidade.value;
    inputs.innerHTML = "";
    for (let i = 1; i <= qtd; i++) {
        const input = document.createElement("input");
        input.value = "Lutador " + i;
        inputs.appendChild(input);
    }
}
criarInputs();

/* ===== EMBARALHAR ===== */
function shuffle(arr) {
    for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
    }
}

function embaralharInputs() {
    const values = [...inputs.children].map(i => i.value);
    shuffle(values);
    [...inputs.children].forEach((i, idx) => i.value = values[idx]);
}

/* ===== INICIAR ===== */
function iniciarTorneio() {
    let nomes = [...inputs.children].map(i => i.value);
    shuffle(nomes);

    rodadas = [nomes];
    historico = [];
    caminhoCampeao = []; // Reset do caminho do campe√£o

    while (rodadas.at(-1).length > 1)
        rodadas.push(new Array(rodadas.at(-1).length / 2).fill("?"));

    setup.style.display = "none";
    bracket.style.display = "flex";
    footer.style.display = "block";
    render();
}

/* ===== RENDER ===== */
function render() {
    bracket.innerHTML = "";

    // Remove an√∫ncio anterior se existir
    const anuncioExistente = document.querySelector(".champion-announcement");
    if (anuncioExistente) anuncioExistente.remove();

    // Adiciona an√∫ncio do campe√£o se houver
    if (rodadas.length > 0 && rodadas[rodadas.length - 1][0] !== "?") {
        const campeao = rodadas[rodadas.length - 1][0];
        const anuncio = document.createElement("div");
        anuncio.className = "champion-announcement";
        anuncio.innerHTML = `
            <h2>üëë CAMPE√ÉO üëë</h2>
            <p>${campeao}</p>
        `;
        bracket.parentNode.insertBefore(anuncio, bracket);
    }

    rodadas.forEach((rodada, r) => {
        const col = document.createElement("div");
        col.className = "round";

        const h = document.createElement("h2");
        h.textContent = r === rodadas.length - 1 ? "üèÜ Campe√£o" : `Rodada ${r + 1}`;
        col.appendChild(h);

        rodada.forEach((nome, i) => {
            const m = document.createElement("div");
            m.className = "match" + (nome === "?" ? " empty" : "");

            // Verifica se faz parte do caminho do campe√£o
            const noCaminho = caminhoCampeao.some(c => c.r === r && c.i === i);
            if (noCaminho) {
                m.classList.add("champion-path");
            } else if (historico.some(h => h.r === r && h.i === i)) {
                m.classList.add("path");
            }

            m.textContent = nome;

            if (r < rodadas.length - 1 && nome !== "?")
                m.onclick = () => vencer(r, i);

            col.appendChild(m);
        });

        bracket.appendChild(col);
    });
}

/* ===== VENCER + CAMINHO DO CAMPE√ÉO ===== */
let caminhoCampeao = [];

function vencer(r, i) {
    const nome = rodadas[r][i];
    const prox = Math.floor(i / 2);

    rodadas[r + 1][prox] = nome;
    
    // Adiciona ao hist√≥rico
    historico.push({ r, i });

    // Se chegou na final, destacar todo o caminho
    if (r + 1 === rodadas.length - 1) {
        destacarCaminhoCompleto();
    }

    render();
}

function destacarCaminhoCompleto() {
    // Reconstr√≥i o caminho completo do campe√£o rastreando de tr√°s para frente
    caminhoCampeao = [];
    
    // Come√ßa do campe√£o (final)
    let posAtual = { r: rodadas.length - 1, i: 0 };
    caminhoCampeao.push({ r: posAtual.r, i: posAtual.i });
    
    // Rastreia todas as posi√ß√µes anteriores do campe√£o
    for (let r = rodadas.length - 2; r >= 0; r--) {
        // A posi√ß√£o atual veio de uma das duas posi√ß√µes anteriores
        // Precisamos encontrar qual delas est√° no hist√≥rico (foi clicada)
        const pos1 = posAtual.i * 2;
        const pos2 = posAtual.i * 2 + 1;
        
        // Verifica qual das duas posi√ß√µes est√° no hist√≥rico (foi a vencedora)
        let posAnterior = pos1;
        if (historico.some(h => h.r === r && h.i === pos2)) {
            posAnterior = pos2;
        }
        
        caminhoCampeao.push({ r, i: posAnterior });
        posAtual = { r, i: posAnterior };
    }
    
    // Inverte para ter do in√≠cio ao fim
    caminhoCampeao.reverse();
}
</script>

</body>
</html>
